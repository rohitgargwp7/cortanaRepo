<phone:PhoneApplicationPage 
    x:Class="windows_client.View.NewChatThread"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:local="clr-namespace:windows_client.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"
    xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls"
    xmlns:c4fToolkit="clr-namespace:Coding4Fun.Phone.Controls;assembly=Coding4Fun.Phone.Controls"
    xmlns:view="clr-namespace:windows_client.View"
    xmlns:templateSelector="clr-namespace:windows_client.TemplateSelectors"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    OrientationChanged="PhoneApplicationPage_OrientationChanged"
    SupportedOrientations="PortraitOrLandscape" Orientation="Portrait"
    mc:Ignorable="d" d:DesignHeight="768" d:DesignWidth="480"
    shell:SystemTray.IsVisible="False">
    <phone:PhoneApplicationPage.Resources>
        <Style x:Name="llsMessagesStyle"  TargetType="phone:LongListSelector">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="phone:LongListSelector">
                        <Grid Background="{TemplateBinding Background}" d:DesignWidth="480" d:DesignHeight="800">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="ScrollStates">
                                    <VisualStateGroup.Transitions>
                                        <VisualTransition GeneratedDuration="00:00:00.5"/>
                                    </VisualStateGroup.Transitions>
                                    <VisualState x:Name="Scrolling">
                                        <Storyboard>
                                            <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="VerticalScrollBar"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="NotScrolling"/>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Grid Margin="0">
                                <ViewportControl x:Name="ViewportControl" HorizontalContentAlignment="Stretch" VerticalAlignment="Bottom" Loaded="ViewPortLoaded"/>
                                <ScrollBar x:Name="VerticalScrollBar" Style="{StaticResource ChatThemeScrollBarStyle}" Opacity="0" Margin="2 0 2 0" Orientation="Vertical" HorizontalAlignment="Right" Width="5" ValueChanged="vScrollBar1_ValueChanged"  />
                            </Grid>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Name="emoticonsStyle"  TargetType="phone:LongListSelector">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="phone:LongListSelector">
                        <Grid Background="{TemplateBinding Background}" d:DesignWidth="480" d:DesignHeight="800">
                            <Grid Margin="0">
                                <ViewportControl x:Name="ViewportControl" HorizontalContentAlignment="Stretch" VerticalAlignment="Top"/>
                                <ScrollBar x:Name="VerticalScrollBar" Opacity="0" Margin="2 0 2 0" Orientation="Vertical" HorizontalAlignment="Right" Width="5" />
                            </Grid>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </phone:PhoneApplicationPage.Resources>

    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ProgressBar Background="Transparent" x:Name="shellProgress" IsIndeterminate="true" Visibility="Collapsed" VerticalAlignment="Top" HorizontalAlignment="Stretch" Canvas.ZIndex="4" Foreground="White"/>

        <Border Grid.RowSpan="3" x:Name="BackgroundColor" Canvas.ZIndex="-3">
            <Image x:Name="chatBackground" Stretch="None"/>
        </Border>

        <Grid x:Name="darkModeLayer" Visibility="Collapsed" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.RowSpan="3" Background="#0a000000" Canvas.ZIndex="-2"/>

        <!--TitlePanel contains the name of the application and page title-->
        <Grid x:Name="HikeTitle" HorizontalAlignment="Stretch" >
            <Border x:Name="headerBackground" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent" BorderBrush="#32000000" BorderThickness="0,0,0,1"/>
            <StackPanel Orientation="Vertical">
                <Grid Height="90">
                    <Grid Name="userHeader" HorizontalAlignment="Stretch" VerticalAlignment="Top" Margin="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid Tap="userImage_Tap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <Image Name="userImage" Height="65" Width="65" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                        </Grid>
                        <StackPanel Margin="12,0" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Center" Tap="userHeader_Tap">
                            <TextBlock x:Name="userName" LineStackingStrategy="BaselineToBaseline" TextTrimming="WordEllipsis" FontWeight="Light" FontSize="32" VerticalAlignment="Top" Foreground="White"/>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Top" x:Name="lastSeenPannel">
                                <TextBlock x:Name="lastSeenTxt" FontSize="16" Foreground="White" FontWeight="Normal"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <Grid x:Name="openNewPinGrid" HorizontalAlignment="Right" VerticalAlignment="Stretch" Grid.Column="2" Tap="createPin_Tap" Margin="0,0" Background="Transparent" Visibility="Collapsed">
                            <Button x:Name="openNewPinButton" Style="{StaticResource ButtonWithImageNoPaddingStyle}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Margin="22,0,0,2">
                                <Button.Content>
                                    <Image x:Name="newPin" Source="/view/images/pin_icon.png" Height="30" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Button.Content>
                            </Button>
                        </Grid>
                        
                        <Grid HorizontalAlignment="Right" VerticalAlignment="Stretch" Grid.Column="3" Tap="chatPaint_Tap" Margin="0,0" Background="Transparent">
                            <Button x:Name="openChatBackgroundButton" Style="{StaticResource ButtonWithImageNoPaddingStyle}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Margin="22,0,0,2">
                                <Button.Content>
                                    <Image x:Name="chatPaint" Source="/view/images/paint.png" Height="60" Width="60" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Button.Content>
                            </Button>
                        </Grid>
                    </Grid>
                    <Grid x:Name="chatThemeHeader" Margin="12" Visibility="Collapsed" HorizontalAlignment="Stretch" Tap="chatThemeHeader_Tap">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid HorizontalAlignment="Right" MinHeight="60" MinWidth="60" VerticalAlignment="Stretch" Tap="chatPaintCancel_Click" Background="Transparent">
                            <Button Style="{StaticResource ButtonWithImageNoPaddingStyle}" HorizontalAlignment="Left" VerticalAlignment="Stretch" Margin="12,0,0,0" toolkit:TiltEffect.IsTiltEnabled="True">
                                <Button.Content>
                                    <Image Source="/View/images/cancel_white.png" Height="30" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Button.Content>
                            </Button>
                        </Grid>
                        <TextBlock x:Name="chatThemeHeaderTxt" FontWeight="Light" FontSize="38" Foreground="White"
                            Text="{Binding Path= LocalizedResources.ChatThemeHeader_Txt, Source={StaticResource LocalizedStrings}}" 
                            Grid.Column="1" Margin="3,-4,0,0" VerticalAlignment="Center"/>
                        <Button x:Name="doneButton" Content="{Binding Path= LocalizedResources.AppBar_Done_Btn, Source={StaticResource LocalizedStrings}}" HorizontalAlignment="Right" FontWeight="Light" Width="120" Height="70" Grid.Column="2" Click="chatPaintSave_Click" Style="{StaticResource SaveButtonChatThemeStyle}"
                            VerticalAlignment="Center" Background="#66000000" Foreground="White" toolkit:TiltEffect.IsTiltEnabled="True"/>
                    </Grid>
                </Grid>
            </StackPanel>
        </Grid>

        <local:PinUC x:Name="gcPin" Canvas.ZIndex="2" Grid.Row="1" Visibility="Collapsed" MinHeight="62" MaxHeight="85" VerticalAlignment="Top" />

        <Grid x:Name="tipControl" Grid.Row="1" Margin="0,-1,0,0" Canvas.ZIndex="1">
            <local:ToolTipsUC x:Name="chatScreenToolTip" ControlBackgroundColor="{StaticResource TipGreen}" VerticalAlignment="Top" />
        </Grid>

        <Grid x:Name="chatBackgroundPopUp" Canvas.ZIndex="3" Grid.Row="1" Visibility="Collapsed" VerticalAlignment="Top" HorizontalAlignment="Stretch" Margin="0,-2,0,0">
            <Border HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Black" Opacity="0.9"/>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <ListBox x:Name="chatBackgroundList" toolkit:TiltEffect.IsTiltEnabled="True" Height="200"
                    ItemsPanel="{StaticResource chatThemeBackgroundListTemplate93x93}"
                    ItemTemplate="{StaticResource chatThemeBackgroundItemTemplate93x93}"
                    SelectionChanged="chatBackgroundList_SelectionChanged"
                    Margin="0,6,0,12" HorizontalAlignment="Center"/>
                <StackPanel x:Name="chatThemeTip" Visibility="Collapsed" Orientation="Horizontal" Margin="12,-3,12,12" Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Bottom">
                    <Image Source="/View/images/notification_Image.png" Opacity="0.7" Height="16" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,3,6,0"/>
                    <TextBlock x:Name="chatThemeTipTxt" Opacity="0.7" FontSize="16" Foreground="White" HorizontalAlignment="Center" TextAlignment="Left" MaxWidth="420"
                          Text="{Binding Path= LocalizedResources.ChatThemeMessage, Source={StaticResource LocalizedStrings}}" TextWrapping="Wrap" />
                </StackPanel>
            </Grid>
        </Grid>

        <Grid Grid.Row="1">
            <Grid x:Name="nudgeTut" Margin="24,0" VerticalAlignment="Center" HorizontalAlignment="Stretch" Visibility="Collapsed">
                <Border x:Name="nudgeBorder" CornerRadius="4" BorderThickness="1" Opacity="0.9" Margin="0,-3" HorizontalAlignment="Stretch" />
                <Grid HorizontalAlignment="Stretch" Margin="12,3" VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Image x:Name="nudgeImage" Height="16" Grid.Column="0" VerticalAlignment="Center" Margin="10,0,10,0" HorizontalAlignment="Left" Source="images/nudge_sent.png"/>
                    <TextBlock x:Name="nudgeText" Grid.Column="1" TextWrapping="Wrap" FontSize="16" 
                               Text="{Binding Path= LocalizedResources.Nudge_Tute, Source={StaticResource LocalizedStrings}}" FontWeight="Light" Margin="3,0,0,0" 
                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="{Binding ChatForegroundColor}"/>
                </Grid>
            </Grid>
            <phone:LongListSelector Name="llsMessages" Style="{StaticResource llsMessagesStyle}" ItemUnrealized="llsMessages_ItemUnRealized" ItemRealized="llsMessages_ItemRealized" HorizontalContentAlignment="Stretch">
                <phone:LongListSelector.ItemTemplate>
                    <DataTemplate>
                        <templateSelector:ChatThreadTemplateSelector Content="{Binding}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalAlignment="Bottom" VerticalContentAlignment="Bottom">
                            <templateSelector:ChatThreadTemplateSelector.DtForceSMSNotification>
                                <DataTemplate>
                                    <Grid HorizontalAlignment="Stretch" Margin="0,-10,24,10">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <TextBlock FontSize="16" Text="{Binding DispMessage}" FontWeight="Light" 
                                                        VerticalAlignment="Center" HorizontalAlignment="Right" MaxWidth="{Binding MessageBubbleWidth}"
                                                        Foreground="{Binding MessageTextForeGround}" TextWrapping="Wrap" TextAlignment="Right"/>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtForceSMSNotification>
                            <templateSelector:ChatThreadTemplateSelector.DtMessageStatus>
                                <DataTemplate>
                                    <Grid HorizontalAlignment="Stretch">
                                        <Border HorizontalAlignment="Right" Margin="0,-10,24,10" CornerRadius="2">
                                            <TextBlock FontSize="16" MaxWidth="{Binding MessageBubbleWidth}" Text="{Binding DispMessage}" FontFamily="Segoe WP SemiLight" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="{Binding MessageTextForeGround}" TextWrapping="Wrap" TextAlignment="Right"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtMessageStatus>
                            <templateSelector:ChatThreadTemplateSelector.DtNotificationBubble>
                                <DataTemplate>
                                    <Grid Margin="24,13,24,13">
                                        <Border CornerRadius="4" BorderThickness="1" Margin="0,-3" Background="{Binding BorderBackgroundColor}" BorderBrush="{Binding NotificationBorderBrush}" HorizontalAlignment="Stretch" />
                                        <Grid HorizontalAlignment="Stretch" Margin="12 3" VerticalAlignment="Center">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Image Height="16" Grid.Column="0" VerticalAlignment="Center" Margin="10,0,10,0" HorizontalAlignment="Left"
                                                   Source="{Binding NotificationImage}"/>
                                            <TextBlock Height="Auto" Grid.Column="1" TextWrapping="Wrap" FontSize="16" 
                                                       Text="{Binding DispMessage}" FontWeight="Light" Margin="3,0,0,0" 
                                                       VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="{Binding ChatForegroundColor}"/>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtNotificationBubble>
                            <templateSelector:ChatThreadTemplateSelector.DtTypingNotificationBubble>
                                <DataTemplate x:Name="dtTypingNotificationBubble" >
                                    <Grid HorizontalAlignment="Stretch" Margin="12,10,0,10">
                                        <Image Source="{Binding TypingNotificationImage}" Height="20" Width="40" HorizontalAlignment="Left"/>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtTypingNotificationBubble>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleText>
                                <DataTemplate>
                                    <Grid Background="Transparent" Margin="12,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Copy_txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Copy"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Visibility="{Binding DirectMessageVisibility}" Click="MenuItem_Click_DirectMessage"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Path Data="M1,0 L0,1 L1,2" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,12,-4,0" 
                                              StrokeThickness="2" Canvas.ZIndex="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            <Grid Grid.Column="1">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Border Grid.RowSpan="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                <local:MyRichTextBox GroupMemberName="{Binding GroupMemberName}" GroupMemberMsisdn="{Binding GroupMemberMsisdn}"
                                                                     TextForeground="{Binding MessageTextForeGround}" MaxWidth="{Binding MessageBubbleWidth}" MinWidth="{Binding MessageBubbleMinWidth}" Text="{Binding DispMessage}" 
                                                                     FontFamily="Segoe WP SemiLight" LinkifyAll="True" Foreground="{Binding MessageTextForeGround}" Margin="0,6,0,0" ViewMoreClicked="ViewMoreMessage_Clicked" HyperlinkClicked="Hyperlink_Clicked"/>
                                                <TextBlock Grid.Row="1" Text="{Binding TimeStampStr}" HorizontalAlignment="Right" Margin="0,5,12,6" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleText>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleFile>
                                <DataTemplate x:Name="dtRecievedBubbleFile">
                                    <Grid Background="Transparent" Margin="12,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Visibility="{Binding DirectMessageVisibility}" Click="MenuItem_Click_DirectMessage"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Left">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Path Data="M1,0 L0,1 L1,2" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,12,-4,0" 
                                              StrokeThickness="2" Canvas.ZIndex="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                                <Grid Grid.Column="1" HorizontalAlignment="Left">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid HorizontalAlignment="Left">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <TextBlock MaxWidth="200" FontFamily="Segoe WP SemiLight" FontWeight="Semibold" TextWrapping="Wrap" Visibility="{Binding GroupMemberVisibility}" HorizontalAlignment="Left" Margin="12,12,12,0" Foreground="{Binding MessageTextForeGround}" >
                                                            <Run Text="{Binding GroupMemberName}"/>
                                                            <Run Text="{Binding GroupMemberMsisdn}"/>
                                                            <Run Text="- "/>
                                                        </TextBlock>
                                                        <Grid Grid.Row="1" HorizontalAlignment="Center" Margin="0,12,0,0">
                                                            <Image MaxWidth="180" MaxHeight="180" Margin="12,0" HorizontalAlignment="Left" Source="{Binding FileAttachment.ThumbnailImage}"/>
                                                            <Image Source="{Binding PlayIconImage}" Opacity="{Binding PauseResumeImageOpacity}" Visibility="{Binding PlayIconVisibility}" MaxHeight="75" VerticalAlignment="Center" HorizontalAlignment="Center" Canvas.ZIndex="2"/>
                                                        </Grid>
                                                    </Grid>
                                                    <Grid Grid.Row="1" Margin="0,5,0,0">
                                                        <TextBlock Text="{Binding FileSize}" Visibility="{Binding FileSizeVisibility}" HorizontalAlignment="Left" Margin="12,0,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" HorizontalAlignment="Right" Margin="12,0,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                                    </Grid>
                                                </Grid>
                                            </Grid>
                                            <Button Grid.Column="1" Style="{StaticResource FileTransferProgressButtonStyle}" HorizontalAlignment="Left" Margin="10,2,-12,0" Visibility="{Binding PauseResumeImageVisibility}" VerticalAlignment="Center" Click="PauseResume_Tapped" Tag="{Binding MessageId}">
                                                <Button.Content>
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Image Source="{Binding PauseResumeImage}" Opacity="{Binding PauseResumeImageOpacity}" Height="25" VerticalAlignment="Center" Stretch="Uniform" HorizontalAlignment="Left" Margin="0,5,0,0"/>
                                                        <ProgressBar Value="{Binding ProgressBarValue}" Margin="-12,5,0,0" Width="170" Background="#e1e1e1" Foreground="#adadad" Minimum="0" Maximum="100" Grid.Row="1"/>
                                                        <TextBlock Text="{Binding ProgressText}" Visibility="{Binding ProgressBarVisibility}" Margin="0,5,0,0" Foreground="{Binding ChatForegroundColor}" FontSize="16" VerticalAlignment="Center" Grid.Row="2"/>
                                                    </Grid>
                                                </Button.Content>
                                            </Button>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleFile>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleLocation>
                                <DataTemplate x:Name="dtRecievedBubbleLocation" >
                                    <Grid Background="Transparent" Margin="12,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Visibility="{Binding DirectMessageVisibility}" Click="MenuItem_Click_DirectMessage"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Path Data="M1,0 L0,1 L1,2" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,12,-4,0" 
                                              StrokeThickness="2" Canvas.ZIndex="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            <Grid Grid.Column="1" HorizontalAlignment="Left">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                <Grid MaxWidth="400" Margin="12,12,12,0">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock MaxWidth="{Binding MessageBubbleWidth}" TextWrapping="Wrap" Visibility="{Binding GroupMemberVisibility}" FontFamily="Segoe WP SemiLight" FontWeight="Semibold" Margin="0,0,0,12" Foreground="{Binding MessageTextForeGround}">
                                                        <Run Text="{Binding GroupMemberName}"/>
                                                        <Run Text="{Binding GroupMemberMsisdn}"/>
                                                        <Run Text="- "/>
                                                    </TextBlock>
                                                    <Grid Grid.Row="1" HorizontalAlignment="Left">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>
                                                        <Image MaxWidth="160" MaxHeight="160" HorizontalAlignment="Left" Source="{Binding FileAttachment.ThumbnailImage}"/>
                                                        <StackPanel MaxHeight="160" MaxWidth="200" Margin="12,0,0,0" Grid.Column="1" Visibility="{Binding LocationAddressVisibility}" VerticalAlignment="Top">
                                                            <TextBlock Text="{Binding PlaceName}" TextDecorations="Underline" Visibility="{Binding PlaceNameVisibility}" TextWrapping="Wrap" Foreground="{Binding MessageTextForeGround}" FontSize="20" FontWeight="SemiBold" />
                                                            <TextBlock Text="{Binding Address}" Visibility="{Binding AddressVisibility}" TextWrapping="Wrap" Foreground="{Binding MessageTextForeGround}" FontSize="18" TextTrimming="WordEllipsis" />
                                                        </StackPanel>
                                                    </Grid>
                                                    <ProgressBar Grid.Row="2" x:Name="downloadProgress" Value="{Binding ProgressBarValue}" Visibility="{Binding ProgressBarVisibility}" Margin="0,5,0,0" Height="10" Background="#999999" Foreground="#333333" Minimum="0" Maximum="100" Opacity="1"/>
                                                </Grid>
                                                <TextBlock Grid.Row="1" Text="{Binding TimeStampStr}" HorizontalAlignment="Right" Margin="12,5,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleLocation>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleAudioFile>
                                <DataTemplate x:Name="dtRecievedBubbleAudioFile" >
                                    <Grid Background="Transparent" Margin="12,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_DirectMessage" Visibility="{Binding DirectMessageVisibility}"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Left">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Path Data="M1,0 L0,1 L1,2" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,12,-4,0" 
                                              StrokeThickness="2" Canvas.ZIndex="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                                <Grid Grid.Column="1" HorizontalAlignment="Left">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid HorizontalAlignment="Left">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <TextBlock MaxWidth="180" TextWrapping="Wrap" Visibility="{Binding GroupMemberVisibility}" FontFamily="Segoe WP SemiLight" FontWeight="Semibold" Margin="12,12,12,0" Foreground="{Binding MessageTextForeGround}" TextAlignment="Left" HorizontalAlignment="Left">
                                                            <Run Text="{Binding GroupMemberName}"/>
                                                            <Run Text="{Binding GroupMemberMsisdn}"/>
                                                            <Run Text="- "/>
                                                        </TextBlock>
                                                        <Grid Grid.Row="1" Margin="12,12,12,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="45"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Border Margin="0" Background="#3a4150" Canvas.ZIndex="-1" Grid.ColumnSpan="2"/>
                                                            <Image Stretch="Uniform" Opacity="{Binding PauseResumeImageOpacity}" Source="{Binding PlayIconImage}" Grid.Row="1" MaxHeight="18" VerticalAlignment="Center"/>
                                                            <Grid Grid.Column="1">
                                                                <StackPanel Orientation="Horizontal" Canvas.ZIndex="2">
                                                                    <Image Margin="10,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center" Source="/View/images/Mic_icon_grey_small.png" MaxHeight="21"/>
                                                                    <TextBlock Margin="10,0,0,0" Text="{Binding PlayTimeText}" Foreground="White" FontWeight="Light" VerticalAlignment="Center" TextAlignment="Left"/>
                                                                </StackPanel>
                                                                <ProgressBar Style="{StaticResource AudioFilePlayProgressBarStyle}" Value="{Binding PlayProgressBarValue}" Width="180" Height="45" Background="#999999" Foreground="#333333" Minimum="0" Maximum="100"/>
                                                            </Grid>
                                                        </Grid>
                                                    </Grid>
                                                    <Grid Grid.Row="1" Margin="0,5,0,0">
                                                        <TextBlock Text="{Binding FileSize}" Visibility="{Binding FileSizeVisibility}" HorizontalAlignment="Left" Margin="12,0,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" HorizontalAlignment="Right" Margin="12,0,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                                    </Grid>
                                                </Grid>
                                            </Grid>
                                            <Button Grid.Column="1" Style="{StaticResource FileTransferProgressButtonStyle}" HorizontalAlignment="Left" Margin="10,2,-12,0" Visibility="{Binding PauseResumeImageVisibility}" VerticalAlignment="Center" Click="PauseResume_Tapped" Tag="{Binding MessageId}">
                                                <Button.Content>
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Image Source="{Binding PauseResumeImage}" Opacity="{Binding PauseResumeImageOpacity}" Height="25" VerticalAlignment="Center" Stretch="Uniform" HorizontalAlignment="Left" Margin="0,5,0,0"/>
                                                        <ProgressBar Value="{Binding ProgressBarValue}" Margin="-12,5,0,0" Width="170" Background="#e1e1e1" Foreground="#adadad" Minimum="0" Maximum="100" Grid.Row="1"/>
                                                        <TextBlock Text="{Binding ProgressText}" Visibility="{Binding ProgressBarVisibility}" Margin="0,5,0,0" Foreground="{Binding ChatForegroundColor}" FontSize="16" VerticalAlignment="Center" Grid.Row="2"/>
                                                    </Grid>
                                                </Button.Content>
                                            </Button>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleAudioFile>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleNudge>
                                <DataTemplate x:Name="dtRecievedBubbleNudge">
                                    <Grid Background="Transparent" Margin="24,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Visibility="{Binding DirectMessageVisibility}" Click="MenuItem_Click_DirectMessage"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <TextBlock MaxWidth="250" TextWrapping="Wrap" Visibility="{Binding GroupMemberVisibility}" FontFamily="Segoe WP SemiLight" FontWeight="Semibold" Margin="0,12,12,12" Foreground="{Binding MessageTextForeGround}">
                                                <Run Text="{Binding GroupMemberName}"/>
                                                <Run Text="{Binding GroupMemberMsisdn}"/>
                                                <Run Text="- "/>
                                            </TextBlock>
                                            <Image Grid.Row="1" Margin="0,0,0,10" Visibility="{Binding NormalNudgeVisibility}" Height="40" HorizontalAlignment="Left" Source="{Binding NudgeImage}"/>
                                            <Image Grid.Row="1" Margin="0,0,0,10" HorizontalAlignment="Left" Height="65" Stretch="Uniform" Source="{Binding SpecialNudgeImage}" Visibility="{Binding SpecialNudgeVisibility}"/>
                                            <Grid Grid.Row="2" HorizontalAlignment="Left" Margin="5,12">
                                                <Border  CornerRadius="4" Background="{Binding BubbleBackGroundColor}" Margin="-5,-8" Canvas.ZIndex="-1"/>
                                                <TextBlock Text="{Binding TimeStampStr}" Margin="5,0" HorizontalAlignment="Center" FontSize="18" FontWeight="Thin" Foreground="{Binding MessageTextForeGround}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleNudge>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleContact>
                                <DataTemplate x:Name="dtRecievedBubbleContact" >
                                    <Grid Background="Transparent" Margin="12,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Visibility="{Binding DirectMessageVisibility}" Click="MenuItem_Click_DirectMessage"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Path Data="M1,0 L0,1 L1,2" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,12,-4,0" 
                                              StrokeThickness="2" Canvas.ZIndex="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            <Grid Grid.Column="1" HorizontalAlignment="Left">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                <Grid Grid.Row="0" HorizontalAlignment="Left">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock MaxWidth="300" TextWrapping="Wrap" TextAlignment="Left" Visibility="{Binding GroupMemberVisibility}" FontFamily="Segoe WP SemiLight" FontWeight="Semibold" Margin="12,12,12,0" Foreground="{Binding MessageTextForeGround}">
                                                        <Run Text="{Binding GroupMemberName}"/>
                                                        <Run Text="{Binding GroupMemberMsisdn}"/>
                                                        <Run Text="- "/>
                                                    </TextBlock>
                                                    <StackPanel Grid.Row="1" Margin="12,12,12,0" Orientation="Horizontal" HorizontalAlignment="Left">
                                                        <Image HorizontalAlignment="Left" Source="/View/images/menu_contact_icon_black.png" Height="50" />
                                                        <TextBlock HorizontalAlignment="Left" Text="{Binding DispMessage}" FontFamily="Segoe WP SemiLight" Grid.Column="1" Margin="5,8,5,0" TextWrapping="Wrap" MinWidth="150" MaxWidth="330" Foreground="{Binding MessageTextForeGround}"/>
                                                    </StackPanel>
                                                </Grid>
                                                <TextBlock Grid.Row="1" Text="{Binding TimeStampStr}" HorizontalAlignment="Right" Margin="12,5,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleContact>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleUnknownFile>
                                <DataTemplate x:Name="dtRecievedBubbleUnknownFile" >
                                    <Grid Background="Transparent" Margin="12,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Visibility="{Binding DirectMessageVisibility}" Click="MenuItem_Click_DirectMessage"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Left">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Path Data="M1,0 L0,1 L1,2" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,12,-4,0" 
                                              StrokeThickness="2" Canvas.ZIndex="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                                <Grid Grid.Column="1" HorizontalAlignment="Left">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid >
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <TextBlock MaxWidth="250" TextWrapping="Wrap" Visibility="{Binding GroupMemberVisibility}" FontFamily="Segoe WP SemiLight" FontWeight="Semibold" Margin="12,12,12,0" Foreground="{Binding MessageTextForeGround}">
                                                            <Run Text="{Binding GroupMemberName}"/>
                                                            <Run Text="{Binding GroupMemberMsisdn}"/>
                                                            <Run Text="- "/>
                                                        </TextBlock>
                                                        <Grid Grid.Row="1" Margin="12,12,12,0" >
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Image Height="60" HorizontalAlignment="Center" Stretch="Uniform" VerticalAlignment="Top" Source="{Binding UnknownFileTypeIconImage}" />
                                                            <Grid Grid.Column="1">
                                                                <Grid Margin="5" Width="180">
                                                                    <Grid.RowDefinitions>
                                                                        <RowDefinition Height="Auto" />
                                                                        <RowDefinition Height="Auto" />
                                                                    </Grid.RowDefinitions>
                                                                    <TextBlock Text="{Binding FileName}" TextWrapping="Wrap" Foreground="{Binding MessageTextForeGround}"/>
                                                                    <TextBlock Grid.Row="1" Text="{Binding FileType}" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                                                </Grid>
                                                            </Grid>
                                                        </Grid>
                                                    </Grid>
                                                    <Grid Grid.Row="1">
                                                        <TextBlock Text="{Binding FileSize}" Visibility="{Binding FileSizeVisibility}" HorizontalAlignment="Left" Margin="12,0,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" HorizontalAlignment="Right" Margin="12,0,12,6" FontSize="18" Foreground="{Binding MessageTextForeGround}" FontWeight="Light"/>
                                                    </Grid>
                                                </Grid>
                                            </Grid>
                                            <Button Grid.Column="1" Style="{StaticResource FileTransferProgressButtonStyle}" HorizontalAlignment="Left" Margin="10,2,-12,0" Visibility="{Binding PauseResumeImageVisibility}" VerticalAlignment="Center" Click="PauseResume_Tapped" Tag="{Binding MessageId}">
                                                <Button.Content>
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Image Source="{Binding PauseResumeImage}" Opacity="{Binding PauseResumeImageOpacity}" Height="25" VerticalAlignment="Center" Stretch="Uniform" HorizontalAlignment="Left" Margin="0,5,0,0"/>
                                                        <ProgressBar Value="{Binding ProgressBarValue}" Margin="-12,5,0,0" Width="170" Background="#e1e1e1" Foreground="#adadad" Minimum="0" Maximum="100" Grid.Row="1"/>
                                                        <TextBlock Text="{Binding ProgressText}" Visibility="{Binding ProgressBarVisibility}" Margin="0,5,0,0" Foreground="{Binding ChatForegroundColor}" FontSize="16" VerticalAlignment="Center" Grid.Row="2"/>
                                                    </Grid>
                                                </Button.Content>
                                            </Button>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedBubbleUnknownFile>
                            <templateSelector:ChatThreadTemplateSelector.DtRecievedSticker>
                                <DataTemplate x:Name="dtRecievedSticker">
                                    <Grid Background="Transparent" Margin="24,10,0,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Left" Tap="ChatMessage_Tapped">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.DirectMsg_Txt, Source={StaticResource LocalizedStrings}}" Visibility="{Binding DirectMessageVisibility}" Click="MenuItem_Click_DirectMessage"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <TextBlock MaxWidth="250" TextWrapping="Wrap" Visibility="{Binding GroupMemberVisibility}" FontFamily="Segoe WP SemiLight" FontWeight="Semibold" Margin="0,12,12,12" Foreground="{Binding MessageTextForeGround}">
                                                <Run Text="{Binding GroupMemberName}"/>
                                                <Run Text="{Binding GroupMemberMsisdn}"/>
                                                <Run Text="- "/>
                                            </TextBlock>
                                            <Grid Grid.Row="1" Visibility="{Binding IsStickerVisible}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Image HorizontalAlignment="Left" Source="{Binding StickerObj.StickerImage}" Stretch="None"/>
                                                <Grid Grid.Row="1" HorizontalAlignment="Left" Margin="5,12">
                                                    <Border CornerRadius="4" Background="{Binding BubbleBackGroundColor}" Margin="-5,-8" Canvas.ZIndex="-1"/>
                                                    <TextBlock Text="{Binding TimeStampStr}" FontWeight="Thin" Margin="5,0" HorizontalAlignment="Right" FontSize="18" Foreground="{Binding MessageTextForeGround}"/>
                                                </Grid>
                                            </Grid>
                                            <Grid Grid.Row="1" Visibility="{Binding IsStickerLoading}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <ProgressBar Foreground="{Binding MessageTextForeGround}" IsIndeterminate="True" IsEnabled="True" HorizontalAlignment="Stretch" Margin="0 0 0 30"/>
                                                <TextBlock Grid.Row="1" Text="{Binding Path=LocalizedResources.DownloadingSticker_txt, Source={StaticResource LocalizedStrings}}" HorizontalAlignment="Center" Margin="12,0,12,12" FontSize="18" Foreground="{Binding MessageTextForeGround}" TextAlignment="Left" />
                                            </Grid>
                                            <Grid Grid.Row="1" Visibility="{Binding IsHttpFailed}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Image Source="/View/images/download_failed_bubble.png" MaxHeight="69" Margin="0 0 0 10" HorizontalAlignment="Center"/>
                                                <TextBlock Grid.Row="1" Text="{Binding Path=LocalizedResources.StickerDownloadFailed, Source={StaticResource LocalizedStrings}}"  HorizontalAlignment="Center" Margin="12,0,12,0" FontSize="18" Foreground="{Binding MessageTextForeGround}"/>
                                                <TextBlock Grid.Row="2" Text="{Binding Path=LocalizedResources.TapHereToRetyTxt, Source={StaticResource LocalizedStrings}}" HorizontalAlignment="Center" Margin="12,0,12,12" FontSize="18" Foreground="{Binding MessageTextForeGround}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtRecievedSticker>
                            <templateSelector:ChatThreadTemplateSelector.DtSentBubbleText>
                                <DataTemplate x:Name="dtSentBubbleText" >
                                    <Grid Background="Transparent" Margin="0,10,12,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Copy_txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Copy"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Right">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                <local:MyRichTextBox TextForeground="{Binding MessageTextForeGround}" MaxWidth="{Binding MessageBubbleWidth}" MinWidth="{Binding MessageBubbleMinWidth}" Text="{Binding DispMessage}" FontFamily="Segoe WP SemiLight"
                                                                 LinkifyAll="True" Foreground="{Binding MessageTextForeGround}" Margin="0,6,0,0" ViewMoreClicked="ViewMoreMessage_Clicked" HyperlinkClicked="Hyperlink_Clicked" />
                                                <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="12,5,0,6">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Image Source="{Binding SdrImage}" Opacity="0.7" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Right" Margin="5,0"/>
                                                    <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0,12,0" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                                </Grid>
                                            </Grid>
                                            <Path Data="M0,0 L1,1 L0,2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="-3.5,12,0,0" 
                                              StrokeThickness="2" Canvas.ZIndex="1" Grid.Column="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentBubbleText>
                            <templateSelector:ChatThreadTemplateSelector.DtSentBubbleLocation>
                                <DataTemplate x:Name="DtSentBubbleLocation" >
                                    <Grid Background="Transparent" Margin="0,10,12,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.View_File, Source={StaticResource LocalizedStrings}}" Visibility="{Binding MediaActionVisibility}" Click="MenuItem_Click_View"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Right" Margin="0,0,10,0" VerticalAlignment="Center">
                                                <Image Opacity="{Binding PauseResumeImageOpacity}" Source="{Binding FileFailedImage}" Margin="0,-14,0,0" Visibility="{Binding FileFailedImageVisibility}" Width="30" VerticalAlignment="Center" Stretch="Uniform"/>
                                            </Grid>
                                            <Grid Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid HorizontalAlignment="Right">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid MaxWidth="400" Margin="12,12,12,0">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>
                                                            <Image Grid.Column="1" MaxWidth="160" MaxHeight="160" HorizontalAlignment="Left" Source="{Binding FileAttachment.ThumbnailImage}"/>
                                                            <StackPanel MaxHeight="160" MaxWidth="200" Margin="0,0,12,0" Visibility="{Binding LocationAddressVisibility}" VerticalAlignment="Top">
                                                                <TextBlock Text="{Binding PlaceName}" TextDecorations="Underline" Visibility="{Binding PlaceNameVisibility}" TextWrapping="Wrap" Foreground="{Binding MessageTextForeGround}" FontSize="20" FontWeight="SemiBold" />
                                                                <TextBlock Text="{Binding Address}" Visibility="{Binding AddressVisibility}" TextWrapping="Wrap" Foreground="{Binding MessageTextForeGround}" FontSize="18" TextTrimming="WordEllipsis" />
                                                            </StackPanel>
                                                        </Grid>
                                                        <ProgressBar Grid.Row="1" x:Name="downloadProgress" Value="{Binding ProgressBarValue}" Visibility="{Binding ProgressBarVisibility}" Margin="0,5,0,0" Height="10" Background="#999999" Foreground="#333333" Minimum="0" Maximum="100" Opacity="1"></ProgressBar>
                                                    </Grid>
                                                    <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="12,5,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Image Source="{Binding SdrImage}" Opacity="0.7" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Right" Margin="5,0"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0,12,0" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                                    </Grid>
                                                </Grid>
                                                <Path Data="M0,0 L1,1 L0,2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="-3.5,12,0,0" StrokeThickness="2" Canvas.ZIndex="1" Grid.Column="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentBubbleLocation>
                            <templateSelector:ChatThreadTemplateSelector.DtSentBubbleFile>
                                <DataTemplate x:Name="dtSentBubbleFile" >
                                    <Grid Background="Transparent"  Margin="0,10,12,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.View_File, Source={StaticResource LocalizedStrings}}" Visibility="{Binding MediaActionVisibility}" Click="MenuItem_Click_View"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Right" Margin="0,10,10,0" VerticalAlignment="Center">
                                                <Image Opacity="{Binding PauseResumeImageOpacity}" Source="{Binding FileFailedImage}" Margin="0,-14,0,0" Visibility="{Binding FileFailedImageVisibility}" Width="30" VerticalAlignment="Center" Stretch="Uniform"/>
                                                <Button Style="{StaticResource FileTransferProgressButtonStyle}" HorizontalAlignment="Right" Margin="-12,-20,2,0" Visibility="{Binding PauseResumeImageVisibility}" Click="PauseResume_Tapped" Tag="{Binding MessageId}">
                                                    <Button.Content>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Image Source="{Binding PauseResumeImage}" Opacity="{Binding PauseResumeImageOpacity}" Height="25" VerticalAlignment="Center" Stretch="Uniform" HorizontalAlignment="Right" Margin="0,5,0,0"/>
                                                            <ProgressBar Value="{Binding ProgressBarValue}" Margin="0,5,-10,0" Width="170" Background="#e1e1e1" Foreground="#adadad" Minimum="0" Maximum="100" HorizontalAlignment="Right" Grid.Row="1"/>
                                                            <TextBlock Text="{Binding ProgressText}" Margin="0,5,0,0" Foreground="{Binding ChatForegroundColor}" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Row="2"/>
                                                        </Grid>
                                                    </Button.Content>
                                                </Button>
                                            </Grid>
                                            <Grid Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid HorizontalAlignment="Center">
                                                        <Image MaxWidth="180" MaxHeight="180" Margin="12,12,12,0" HorizontalAlignment="Left" Source="{Binding FileAttachment.ThumbnailImage}"/>
                                                        <Image Source="{Binding PlayIconImage}" Opacity="{Binding PauseResumeImageOpacity}" Visibility="{Binding PlayIconVisibility}" MaxHeight="75" VerticalAlignment="Center" HorizontalAlignment="Center" Canvas.ZIndex="2"/>
                                                    </Grid>
                                                    <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="12,5,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Image Source="{Binding SdrImage}" Opacity="0.7" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Right" Margin="5,0"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0,12,0" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                                    </Grid>
                                                </Grid>
                                                <Path Data="M0,0 L1,1 L0,2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="-3.5,12,0,0" StrokeThickness="2" Canvas.ZIndex="1" Grid.Column="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentBubbleFile>
                            <templateSelector:ChatThreadTemplateSelector.DtSentBubbleAudioFile>
                                <DataTemplate x:Name="dtSentBubbleAudioFile" >
                                    <Grid Background="Transparent" Margin="0,10,12,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Play_File, Source={StaticResource LocalizedStrings}}" Visibility="{Binding MediaActionVisibility}" Click="MenuItem_Click_View"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Right" Margin="0,10,10,0" VerticalAlignment="Center">
                                                <Image Opacity="{Binding PauseResumeImageOpacity}" Source="{Binding FileFailedImage}" Margin="0,-14,0,0" Visibility="{Binding FileFailedImageVisibility}" Width="30" VerticalAlignment="Center" Stretch="Uniform"/>
                                                <Button Style="{StaticResource FileTransferProgressButtonStyle}" HorizontalAlignment="Right" Margin="-12,-20,2,0" Visibility="{Binding PauseResumeImageVisibility}" Click="PauseResume_Tapped" Tag="{Binding MessageId}">
                                                    <Button.Content>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Image Source="{Binding PauseResumeImage}" Opacity="{Binding PauseResumeImageOpacity}" Height="25" VerticalAlignment="Center" Stretch="Uniform" HorizontalAlignment="Right" Margin="0,5,0,0"/>
                                                            <ProgressBar Value="{Binding ProgressBarValue}" Margin="0,5,-10,0" Width="170" Background="#e1e1e1" Foreground="#adadad" Minimum="0" Maximum="100" HorizontalAlignment="Right" Grid.Row="1"/>
                                                            <TextBlock Text="{Binding ProgressText}" Margin="0,5,0,0" Foreground="{Binding ChatForegroundColor}" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Row="2"/>
                                                        </Grid>
                                                    </Button.Content>
                                                </Button>
                                            </Grid>
                                            <Grid Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid Margin="10">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="45"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Border Margin="0" Background="#3a4150" Canvas.ZIndex="-1" Grid.ColumnSpan="2"/>
                                                        <Image Stretch="Uniform" Opacity="{Binding PauseResumeImageOpacity}" Source="{Binding PlayIconImage}" Grid.Row="1" HorizontalAlignment="Center" MaxHeight="18" VerticalAlignment="Center"/>
                                                        <Grid Grid.Column="1">
                                                            <StackPanel Orientation="Horizontal" Canvas.ZIndex="2">
                                                                <Image Margin="10,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center" Source="/View/images/Mic_icon_grey_small.png" MaxHeight="21"/>
                                                                <TextBlock Margin="10,0,0,0" Text="{Binding PlayTimeText}" Foreground="White" FontWeight="Light" VerticalAlignment="Center" TextAlignment="Left"/>
                                                            </StackPanel>
                                                            <ProgressBar Style="{StaticResource AudioFilePlayProgressBarStyle}" x:Name="playProgress" Value="{Binding PlayProgressBarValue}" Width="180" Height="45" Background="#999999" Foreground="#333333" Minimum="0" Maximum="100"/>
                                                        </Grid>
                                                    </Grid>
                                                    <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="12,-5,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Image Source="{Binding SdrImage}" Opacity="0.7" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Right" Margin="5,0"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0,12,0" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                                    </Grid>
                                                </Grid>
                                                <Path Data="M0,0 L1,1 L0,2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="-3.5,12,0,0" StrokeThickness="2" Canvas.ZIndex="1" Grid.Column="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentBubbleAudioFile>
                            <templateSelector:ChatThreadTemplateSelector.DtSentBubbleNudge>
                                <DataTemplate x:Name="dtSentBubbleNudge" >
                                    <Grid Background="Transparent" Margin="0,10,24,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Image Height="40" Margin="0,0,0,10" Visibility="{Binding NormalNudgeVisibility}" HorizontalAlignment="Right" Source="{Binding NudgeImage}"/>
                                            <Image Height="65" Stretch="Uniform" Margin="0,0,0,10" HorizontalAlignment="Right" Source="{Binding SpecialNudgeImage}" Visibility="{Binding SpecialNudgeVisibility}"/>
                                            <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="5,12">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Border Grid.ColumnSpan="2" CornerRadius="4" Background="{Binding BubbleBackGroundColor}" Margin="-5,-8" Canvas.ZIndex="-1"/>
                                                <Grid Width="32" Margin="5,0" HorizontalAlignment="Right">
                                                    <Image Source="{Binding SdrImage}" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Center"/>
                                                </Grid>
                                                <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0" FontSize="18" FontWeight="Thin" Foreground="{Binding MessageTextForeGround}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentBubbleNudge>
                            <templateSelector:ChatThreadTemplateSelector.DtSentBubbleContact>
                                <DataTemplate x:Name="dtSentBubbleContact" >
                                    <Grid Background="Transparent" Margin="0,10,12,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Open_File, Source={StaticResource LocalizedStrings}}" Visibility="{Binding MediaActionVisibility}" Click="MenuItem_Click_View"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Right" Margin="0,0,10,0" VerticalAlignment="Center">
                                                <Image Opacity="{Binding PauseResumeImageOpacity}" Source="{Binding FileFailedImage}" Margin="0,-14,0,0" Visibility="{Binding FileFailedImageVisibility}" Width="30" VerticalAlignment="Center" Stretch="Uniform"/>
                                            </Grid>
                                            <Grid Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid HorizontalAlignment="Right">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid >
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Image Margin="12,12,12,0" HorizontalAlignment="Left" Height="50" Source="/View/images/menu_contact_icon_black.png" />
                                                        <TextBlock Text="{Binding DispMessage}" FontFamily="Segoe WP SemiLight" Grid.Column="1" Margin="0,8,5,0" TextWrapping="Wrap" MinWidth="150" MaxWidth="330" Foreground="{Binding MessageTextForeGround}"/>
                                                    </Grid>
                                                    <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="12,5,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Image Source="{Binding SdrImage}" Opacity="0.7" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Right" Margin="5,0"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0,12,0" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                                    </Grid>
                                                </Grid>
                                                <Path Data="M0,0 L1,1 L0,2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="-3.5,12,0,0" StrokeThickness="2" Canvas.ZIndex="1" Grid.Column="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentBubbleContact>
                            <templateSelector:ChatThreadTemplateSelector.DtSentBubbleUnknownFile>
                                <DataTemplate x:Name="dtSentBubbleUnknownFile" >
                                    <Grid Background="Transparent" Margin="0,10,12,10" HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <toolkit:ContextMenuService.ContextMenu>
                                                <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Cancel_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Cancel" Visibility="{Binding ShowCancelMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete" Visibility="{Binding ShowDeleteMenu}"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                    <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.View_File, Source={StaticResource LocalizedStrings}}" Visibility="{Binding MediaActionVisibility}" Click="MenuItem_Click_View"/>
                                                </toolkit:ContextMenu>
                                            </toolkit:ContextMenuService.ContextMenu>
                                            <Grid HorizontalAlignment="Right" Margin="0,10,10,0" VerticalAlignment="Center">
                                                <Image Opacity="{Binding PauseResumeImageOpacity}" Source="{Binding FileFailedImage}" Margin="0,-14,0,0" Visibility="{Binding FileFailedImageVisibility}" Width="30" VerticalAlignment="Center" Stretch="Uniform"/>
                                                <Button Style="{StaticResource FileTransferProgressButtonStyle}" HorizontalAlignment="Right" Margin="-12,-20,2,0" Visibility="{Binding PauseResumeImageVisibility}" Click="PauseResume_Tapped" Tag="{Binding MessageId}">
                                                    <Button.Content>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Image Source="{Binding PauseResumeImage}" Opacity="{Binding PauseResumeImageOpacity}" Height="25" VerticalAlignment="Center" Stretch="Uniform" HorizontalAlignment="Right" Margin="0,5,0,0"/>
                                                            <ProgressBar Value="{Binding ProgressBarValue}" Margin="0,5,-10,0" Width="170" Background="#e1e1e1" Foreground="#adadad" Minimum="0" Maximum="100" HorizontalAlignment="Right" Grid.Row="1"/>
                                                            <TextBlock Text="{Binding ProgressText}" Margin="0,5,0,0" Foreground="{Binding ChatForegroundColor}" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Row="2"/>
                                                        </Grid>
                                                    </Button.Content>
                                                </Button>
                                            </Grid>
                                            <Grid Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Border Grid.RowSpan="2" BorderThickness="2" Background="{Binding BubbleBackGroundColor}" CornerRadius="4"/>
                                                    <Grid Margin="10 10 10 0" >
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Image Height="60" HorizontalAlignment="Center" Stretch="Uniform" VerticalAlignment="Top" Source="{Binding UnknownFileTypeIconImage}" />
                                                        <Grid Grid.Column="1">
                                                            <Grid Margin="5" Width="180">
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="Auto" />
                                                                </Grid.RowDefinitions>
                                                                <TextBlock Text="{Binding FileName}" TextTrimming="WordEllipsis"  Foreground="Black"/>
                                                                <TextBlock Grid.Row="1" Text="{Binding FileType}" TextTrimming="WordEllipsis" FontSize="18" FontWeight="Light" Foreground="Black"/>
                                                            </Grid>
                                                        </Grid>
                                                    </Grid>
                                                    <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="12,0,0,5">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Image Source="{Binding SdrImage}" Opacity="0.7" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Right" Margin="5,0"/>
                                                        <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0,12,0" FontSize="18" FontWeight="Light" Foreground="{Binding MessageTextForeGround}"/>
                                                    </Grid>
                                                </Grid>
                                                <Path Data="M0,0 L1,1 L0,2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="-3.5,12,0,0" StrokeThickness="2" Canvas.ZIndex="1" Grid.Column="1" Stretch="Uniform" UseLayoutRounding="False" Width="10" Fill="{Binding BubbleBackGroundColor}"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentBubbleUnknownFile>
                            <templateSelector:ChatThreadTemplateSelector.DtSentSticker>
                                <DataTemplate x:Name="dtSentSticker">
                                    <Grid Background="Transparent" HorizontalAlignment="Stretch"  Margin="0,10,24,10">
                                        <Grid HorizontalAlignment="Right" Tap="ChatMessage_Tapped">
                                            <Grid Visibility="{Binding IsStickerVisible}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <toolkit:ContextMenuService.ContextMenu>
                                                    <toolkit:ContextMenu Background="Black" IsZoomEnabled="False" HorizontalAlignment="Center" VerticalAlignment="Center" Unloaded="ContextMenu_Unloaded" Loaded="ContextMenu_Loaded">
                                                        <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Forward_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Forward" Visibility="{Binding ShowForwardMenu}"/>
                                                        <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Delete_Txt, Source={StaticResource LocalizedStrings}}" Click="MenuItem_Click_Delete"/>
                                                        <toolkit:MenuItem Foreground="White" Header="{Binding Path= LocalizedResources.Send_As_Sms, Source={StaticResource LocalizedStrings}}" Visibility="{Binding SendAsSMSVisibility}" Click="MenuItem_Click_SendAsSMS"/>
                                                    </toolkit:ContextMenu>
                                                </toolkit:ContextMenuService.ContextMenu>
                                                <Image HorizontalAlignment="Right" Stretch="None" Source="{Binding StickerObj.StickerImage}" Grid.Row="0" Margin="0,0,0,10"/>
                                                <Grid Grid.Row="1" HorizontalAlignment="Right" Margin="5,12">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Border Grid.ColumnSpan="2" CornerRadius="4" Background="{Binding BubbleBackGroundColor}" Margin="-5,-8" Canvas.ZIndex="-1"/>
                                                    <Grid Width="32" Margin="5,0" HorizontalAlignment="Right">
                                                        <Image Source="{Binding SdrImage}" Visibility="{Binding SdrImageVisibility}" Height="13" HorizontalAlignment="Center"/>
                                                    </Grid>
                                                    <TextBlock Text="{Binding TimeStampStr}" Grid.Column="1" HorizontalAlignment="Right" Margin="5,0" FontSize="18" FontWeight="Thin" Foreground="{Binding MessageTextForeGround}"/>
                                                </Grid>
                                            </Grid>
                                            <Grid Visibility="{Binding IsStickerLoading}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <TextBlock Grid.RowSpan="2" Width="250"></TextBlock>
                                                <ProgressBar Foreground="#1ba1e2" IsIndeterminate="True" IsEnabled="True" Width="150" HorizontalAlignment="Stretch" Margin="0 20 0 10"/>
                                                <TextBlock Grid.Row="1" Text="{Binding Path=LocalizedResources.DownloadingSticker_txt, Source={StaticResource LocalizedStrings}}" HorizontalAlignment="Center" Margin="12,0,12,0" FontSize="18" Foreground="{Binding MessageTextForeGround}" TextAlignment="Center" />
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtSentSticker>
                            <templateSelector:ChatThreadTemplateSelector.DtStatusUpdateBubble>
                                <DataTemplate>
                                    <Grid Margin="0,10" HorizontalAlignment="Stretch" Tap="ChatMessage_Tapped">
                                        <Border Background="Black" Opacity="{Binding BorderBGOpacity}"/>
                                        <Grid Margin="5,10">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Image MaxHeight="50" Margin="17,10,0,0" VerticalAlignment="Top" Source="{Binding StatusUpdateImage}"/>
                                            <Grid Grid.Column="1" Margin="12,0,12,5" VerticalAlignment="Center" HorizontalAlignment="Left">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <local:MyRichTextBox MaxLines="2" TextForeground="{Binding MessageTextForeGround}" MaxWidth="{Binding MessageBubbleWidth}" MinWidth="{Binding MessageBubbleMinWidth}" Text="{Binding DispMessage}" FontFamily="Segoe WP SemiLight"
                                                                 LinkifyAll="True" Foreground="{Binding MessageTextForeGround}" Margin="-12,6,0,0" ViewMoreClicked="ViewMoreMessage_Clicked" HyperlinkClicked="Hyperlink_Clicked" />
                                                <TextBlock Grid.Row="1" FontSize="15" Foreground="{Binding MessageTextForeGround}" Opacity="0.6" Text="{Binding TimeStampStr}" VerticalAlignment="Top"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtStatusUpdateBubble>
                            <templateSelector:ChatThreadTemplateSelector.DtGCPin>
                                <DataTemplate>
                                    <Grid Margin="0,10" HorizontalAlignment="Stretch" Tap="PinTemplate_Tapped">
                                        <Border Background="Black" Opacity="{Binding BorderBGOpacity}"/>
                                        <Grid Margin="5,10">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <Image MaxHeight="50" Margin="17,10,0,0" VerticalAlignment="Top" Source="{Binding StatusUpdateImage}"/>

                                            <Grid Grid.Column="1" Margin="17,10,12,10" VerticalAlignment="Top" HorizontalAlignment="Stretch">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock FontSize="18" Text="{Binding GCPinSenderPostedAPin}" Foreground="{Binding MessageTextForeGround}" Opacity="0.6" VerticalAlignment="Top" />
                                                    <TextBlock Grid.Column="1" FontSize="18" Foreground="{Binding MessageTextForeGround}" Opacity="0.6" Text="{Binding TimeStampStr}" VerticalAlignment="Top" HorizontalAlignment="Right" />
                                                </Grid>
                                                <local:MyRichTextBox Grid.Row="1" MaxLines="5" TextForeground="{Binding MessageTextForeGround}" MaxWidth="{Binding MessageBubbleWidth}" MinWidth="{Binding MessageBubbleMinWidth}" Text="{Binding DispMessage}" FontFamily="Segoe WP SemiLight"
                                                                     LinkifyAll="True" Foreground="{Binding MessageTextForeGround}" Margin="-12,0,0,0" HorizontalAlignment="Left" ViewMoreClicked="ViewMoreMessage_Clicked" HyperlinkClicked="Hyperlink_Clicked" />
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </templateSelector:ChatThreadTemplateSelector.DtGCPin>
                            
                        </templateSelector:ChatThreadTemplateSelector>
                    </DataTemplate>
                </phone:LongListSelector.ItemTemplate>
            </phone:LongListSelector>
            <Grid VerticalAlignment="Bottom" HorizontalAlignment="Stretch" x:Name="JumpToBottomGrid" Tap="JumpToBottom_Tapped" Canvas.ZIndex="3" Height="45" Visibility="Collapsed">
                <Border x:Name="jumpToBottomBorder" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{StaticResource HikeBlack}" Opacity="0.95"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" >
                    <Image MaxHeight="15" Margin="0,5,0,0" Source="images/downArrow.png" VerticalAlignment="Center" />
                    <TextBlock Name="txtJumpToBttom" Margin="10,0,0,0" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Grid>

        <StackPanel x:Name="bottomPanel" Height="Auto" Grid.Row="2" Orientation="Vertical" VerticalAlignment="Bottom" Background="Transparent">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="smsCounterTxtBlk" FontSize="18" Margin="24,0,0,12" Visibility="Collapsed" FontWeight="Light" Foreground="{StaticResource HikeDarkGrey}"/>
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 0 24 12" Visibility="Collapsed" Name="spSmsCharCounter">
                    <TextBlock Name="txtMsgCount" FontSize="18" FontWeight="Light" Foreground="{StaticResource HikeDarkGrey}"/>
                    <TextBlock Name="txtMsgCharCount" FontSize="18" FontWeight="Light" Foreground="{StaticResource HikeDarkGrey}"/>
                </StackPanel>
            </Grid>

            <Grid Background="#eeeeec">
                <Grid Background="#eeeeec">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Border MaxHeight="150" Background="#eeeeec" >
                        <toolkit:PhoneTextBox  x:Name="sendMsgTxtbox" Background="#eeeeec" InputScope="Text" BorderThickness="0" ActualHintVisibility="Visible" GotFocus="sendMsgTxtbox_GotFocus" AcceptsReturn="True" Hint="" 
                                               TextWrapping="Wrap" TextChanged="sendMsgTxtbox_TextChanged" KeyDown="MsgCharTapped" 
                                                MinHeight="72" MaxHeight="130" MaxLength="10000" VerticalAlignment="Top" FontFamily="Segoe WP SemiLight" LostFocus="sendMsgTxtbox_LostFocus" VerticalScrollBarVisibility="Auto"  />
                    </Border>
                    <Grid Grid.Column="1" MinWidth="60" Background="#eeeeec" Tap="ActionIcon_Tapped">
                        <Image x:Name="actionIcon" Source="/View/images/Mic_icon_black_small.png" HorizontalAlignment="Center" VerticalAlignment="Bottom" Stretch="Uniform" Margin="0,0,0,20" MaxHeight="30"/>
                    </Grid>
                </Grid>
                <Grid x:Name="recordGrid" HorizontalAlignment="Stretch" Visibility="Collapsed" Background="#eeeeec">
                    <Grid Margin="5" x:Name="recordButtonGrid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" ManipulationStarted="Hold_To_Record" ManipulationCompleted="recordButton_ManipulationCompleted">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" >
                            <Image Stretch="Uniform" Margin="0,0,10,0" MaxHeight="30" x:Name="walkieTalkieImage" Source="/View/images/Walkie_Talkie_White_small.png" VerticalAlignment="Center"/>
                            <TextBlock x:Name="recordButton" Foreground="White" TextAlignment="Left" VerticalAlignment="Center" HorizontalAlignment="Left" FontSize="24" Text=""/>
                        </StackPanel>
                    </Grid>
                    <Grid Width="62" Margin="5" Height="62" Canvas.ZIndex="2" x:Name="cancelRecord" Tap="cancelRecord_Tap" Background="Transparent" HorizontalAlignment="Right">
                        <Image MaxHeight="18" Opacity="0.5" Source="/View/images/remove_wt_icon.png" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Grid>
                </Grid>
            </Grid>

            <Grid Visibility="Collapsed"  x:Name="emoticonPanel" MaxHeight="350" MinHeight="319" Background="#323232">
                <Grid Name="gridEmoticons" Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <controls:Pivot Name="emoticonPivot" SelectionChanged="emoticonPivot_SelectionChanged" Foreground="White" MaxHeight="265">
                        <controls:PivotItem Margin="0,-10">
                            <Grid x:Name="emotGridRecent" HorizontalAlignment="Stretch"  VerticalAlignment="Stretch">
                                <Grid Name="gridShowRecents">
                                    <ListBox Name="emotListRecent" HorizontalAlignment="Center" Visibility="Visible" SelectionChanged="emotListRecent_Tap">
                                        <ListBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <toolkit:WrapPanel ItemHeight="65" ItemWidth="65"/>
                                            </ItemsPanelTemplate>
                                        </ListBox.ItemsPanel>

                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Image Margin="5,5,5,5" Height="40" Width="40" Source="{Binding Image}">
                                                </Image>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>
                                <Grid Name="gridNoRecents">
                                    <TextBlock Text="{Binding Path= LocalizedResources.RecentEmoticons_DefaultText, Source={StaticResource LocalizedStrings}}" FontSize="20" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="40 0 40 0" TextWrapping="Wrap" TextAlignment="Center"/>
                                </Grid>
                            </Grid>
                        </controls:PivotItem>
                        <controls:PivotItem Margin="0,-10">
                            <Grid x:Name="emotGrid0">
                                <ListBox Name="emotList0" HorizontalAlignment="Center" Visibility="Visible" Tap="emotList0_Tap">
                                    <ListBox.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <toolkit:WrapPanel ItemHeight="65" ItemWidth="65"/>
                                        </ItemsPanelTemplate>
                                    </ListBox.ItemsPanel>

                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Image Margin="5,5,5,5" Height="40" Width="40" Source="{Binding}">
                                            </Image>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Grid>
                        </controls:PivotItem>
                        <controls:PivotItem Margin="0,-10">
                            <Grid x:Name="emotGrid1">
                                <ListBox Name="emotList1" HorizontalAlignment="Center" Visibility="Visible" Tap="emotList1_Tap">
                                    <ListBox.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <toolkit:WrapPanel ItemHeight="65" ItemWidth="65"/>
                                        </ItemsPanelTemplate>
                                    </ListBox.ItemsPanel>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Image Margin="5,5,5,5" Height="40" Width="40" Source="{Binding}">
                                            </Image>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Grid>
                        </controls:PivotItem>
                        <controls:PivotItem Margin="0,-10">
                            <Grid x:Name="emotGrid2">
                                <ListBox Name="emotList2" HorizontalAlignment="Center" Visibility="Visible" Tap="emotList2_Tap">
                                    <ListBox.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <toolkit:WrapPanel ItemHeight="65" ItemWidth="65"/>
                                        </ItemsPanelTemplate>
                                    </ListBox.ItemsPanel>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Image Margin="5,5,5,5" Height="45" Width="45" Source="{Binding}">
                                            </Image>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Grid>
                        </controls:PivotItem>
                        <controls:PivotItem Margin="0,8,0,0" Name="indianEmoticonPivot">
                            <Grid x:Name="emotGrid3">
                                <ListBox Name="emotList3" HorizontalAlignment="Center" Visibility="Visible" Tap="emotList3_Tap">
                                    <ListBox.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <toolkit:WrapPanel ItemHeight="65" ItemWidth="65"/>
                                        </ItemsPanelTemplate>
                                    </ListBox.ItemsPanel>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Image Margin="5,5,5,5" Height="45" Width="45" Source="{Binding}">
                                            </Image>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Grid>
                        </controls:PivotItem>
                    </controls:Pivot>
                    <Grid Height="50" Grid.Row="1" VerticalAlignment="Bottom" Margin="-12,0" Name="gridEmoticonLabels">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#4d4d4d" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Tap="emotHeaderRectRecent_Tap">
                            <Image Name="emotRecent" Source="images\recent_inactive.png" Height="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <Border Grid.Column="1" Background="#4d4d4d" Margin="2,0,0,0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Tap="emotHeaderRect0_Tap">
                            <Image Name="emotCat0" Source="images\emoticons\emo_im_01_bigsmile.png" Height="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <Border Grid.Column="2" Background="#4d4d4d" Margin="2,0,0,0"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Tap="emotHeaderRect1_Tap" >
                            <Image Name="emotCat1" Source="images\emoticons\emo_im_81_exciting.png" Height="30" HorizontalAlignment="Center"  VerticalAlignment="Center"/>
                        </Border>
                        <Border Grid.Column="3" Background="#4d4d4d" Margin="2,0,0,0"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Tap="emotHeaderRect2_Tap">
                            <Image Name="emotCat2" Source="images\emoticons\emo_im_111_grin.png" Height="30" Margin="0 4 0 0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <Border Grid.Column="4"  Background="#4d4d4d" Margin="2,0,0,0"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Tap="emotHeaderRect3_Tap">
                            <Image Name="emotCat3" Source="images\emoticons\tiranga4.png" Height="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <Button Name="btnBackKey" Style="{StaticResource ButtonWithNoPaddingStyle}" Margin="2,0,0,0" BorderThickness="0"  Grid.Column="5" Background="#4d4d4d"   VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Tap="OnEmoticonBackKeyPress" >
                            <Image Source="images\emoticon_back_key.png"  Height="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button>
                    </Grid>
                </Grid>
                <Grid Name="gridStickers" Visibility="Collapsed" Background="#323232">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid x:Name="stickerPallet"/>

                    <ListBox Name="lbStickerCategories" ScrollViewer.VerticalScrollBarVisibility="Disabled" ScrollViewer.HorizontalScrollBarVisibility="Auto" Grid.Row="1" SelectionChanged="StickerCategory_SelectionChanged">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>

                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0 0 2 0">
                                    <Border BorderBrush="#F14B4B" Width="75" Height="50" BorderThickness="{Binding BorderThickness}" Background="{Binding BackgroundColor}" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Canvas.ZIndex="-1"/>
                                    <Image Source="{Binding CategoryIcon}" Height="30" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Grid>

            <Grid x:Name="attachmentMenu" Visibility="Collapsed" Height="319" Background="#080808" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Button Grid.Column="0" Grid.Row="0" Margin="0,0,1,0" Background="#292929" Tap="clickPhoto_Tap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Style="{StaticResource AttachmentIconButtonStyle}">
                    <Button.Content>
                        <StackPanel Margin="0,5,0,0" Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Image Source="images\menu_camera_icon.png" Height="45" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Margin="5,20,5,0" Text="{Binding Path= LocalizedResources.Attachment_Camera_Txt, Source={StaticResource LocalizedStrings}}" FontSize="16" Foreground="#f6f6f6" HorizontalAlignment="Center" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <Button Grid.Column="1" Grid.Row="0" Margin="0,0,1,0" Background="#292929" Tap="sendImage_Tap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Style="{StaticResource AttachmentIconButtonStyle}">
                    <Button.Content>
                        <StackPanel Margin="0,5,0,0" Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Image Source="images\menu_photo_icon.png" Height="45" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock  Margin="5,20,5,0" Text="{Binding Path= LocalizedResources.Attachment_Photo_Txt, Source={StaticResource LocalizedStrings}}" FontSize="16" Foreground="#f6f6f6" HorizontalAlignment="Center" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <Button Grid.Column="2" Grid.Row="0" Background="#292929" Tap="sendVideo_Tap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Style="{StaticResource AttachmentIconButtonStyle}">
                    <Button.Content>
                        <StackPanel Margin="0,5,0,0" Orientation="Vertical"  VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Image Source="images\menu_video_icon.png" Height="45" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Margin="5,20,5,0" Text="{Binding Path= LocalizedResources.Attachment_Video_Txt, Source={StaticResource LocalizedStrings}}" FontSize="16" HorizontalAlignment="Center" Foreground="#f6f6f6" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>


                <Button Grid.Column="0" Grid.Row="1" Margin="0,1,1,0" Background="#292929" Tap="sendCamcorder_Tap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Style="{StaticResource AttachmentIconButtonStyle}">
                    <Button.Content>
                        <StackPanel Margin="0,5,0,0" Orientation="Vertical"  VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Image Source="images\menu_camcorder_icon.png" Height="45" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Margin="5,20,5,0" Text="{Binding Path= LocalizedResources.Attachment_Camcorder_Txt, Source={StaticResource LocalizedStrings}}" FontSize="16" HorizontalAlignment="Center" Foreground="#f6f6f6" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <Button Grid.Column="1" Grid.Row="1" Margin="0,1,1,0" Background="#292929" Tap="shareLocation_Tap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Style="{StaticResource AttachmentIconButtonStyle}">
                    <Button.Content>
                        <StackPanel Margin="0,5,0,0" Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Image Source="images\menu_location_icon.png" Height="45" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Margin="5,20,5,0" Text="{Binding Path= LocalizedResources.Attachment_Location_Txt, Source={StaticResource LocalizedStrings}}" FontSize="16" HorizontalAlignment="Center" Foreground="#f6f6f6" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <Button Name="spContactTransfer" Grid.Column="2" Grid.Row="1" Margin="0,1,0,0" Background="#292929" Tap="sendContact_Tap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" toolkit:TiltEffect.IsTiltEnabled="True" Style="{StaticResource AttachmentIconButtonStyle}">
                    <Button.Content>
                        <StackPanel Margin="0,5,0,0" Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Image Source="images\menu_contact_icon.png" Height="45" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Margin="5,20,5,0" Text="{Binding Path= LocalizedResources.Attachement_Contact_Txt, Source={StaticResource LocalizedStrings}}" FontSize="16" HorizontalAlignment="Center" Foreground="#f6f6f6" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>
                
            </Grid>
        </StackPanel>
        <ProgressBar x:Name="progressBar" Grid.Row="1" Margin="0,0,0,0" 
                                        Background="Transparent" IsIndeterminate="True" 
                                        VerticalAlignment="Center" 
                                        VerticalContentAlignment="Center" FontSize="24" 
                                        HorizontalAlignment="Stretch" Height="10"
                                        HorizontalContentAlignment="Center" 
                                        IsEnabled="False" IsTabStop="True" Opacity="0"/>

        <Border Canvas.ZIndex="4" x:Name="overlayBorder" Grid.RowSpan="3" Background="Black" Visibility="Collapsed" Opacity="0.9" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
        <StackPanel Canvas.ZIndex="4" x:Name="overlayMessagePanel" Visibility="Collapsed" Grid.RowSpan="3" VerticalAlignment="Center" Margin="25,0,25,0" Orientation="Vertical">
            <Image Source="images\ic_block_active.png" Height="125" Stretch="Uniform"/>
            <TextBlock Name="BlockTxtBlk" FontWeight="Light" HorizontalAlignment="Center" Margin="15,50" TextAlignment="Center" TextWrapping="Wrap" Text="{Binding Path= LocalizedResources.SelectUser_BlockMsg_Txt, Source={StaticResource LocalizedStrings}}" Foreground="White" FontSize="30"/>
            <Button HorizontalAlignment="Center" Name="btnBlockUnblock" Content="{Binding Path= LocalizedResources.UnBlock_Txt, Source={StaticResource LocalizedStrings}}" Click="blockUnblock_Click" Style="{StaticResource YesButtonStyle}"/>
        </StackPanel>
        <Grid Canvas.ZIndex="4" x:Name="gridDownloadStickers" Visibility="Collapsed" Width="340" Grid.RowSpan="3" VerticalAlignment="Center" Margin="0 0 0 0" Tap="overlayBorder_Tapped">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Background="{Binding OverlayBackgroundColor}">
                <Grid Margin="30,30,30,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Image Name="downloadDialogueImage" MaxHeight="280" MaxWidth="280" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding OverlayImage}"/>
                    </Grid>
                    <Grid Grid.Row="1" Margin="0,10,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Name="overlayText" Opacity="0.8" FontSize="26" Text="{Binding OverlayText}" Foreground="White" HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="Wrap"/>
                        <Grid Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Right" Tap="downloadStickers_Tap">
                            <Button Name="btnDownload" Width="150" Foreground="White" Content="{Binding Path= LocalizedResources.Download_txt, Source={StaticResource LocalizedStrings}}"
                                    VerticalAlignment="Bottom" HorizontalAlignment="Right" FontSize="18" Height="70" FontFamily="Segoe WP SemiLight" BorderBrush="#3d3d3d" Background="#3d3d3d"/>
                            <Button Name="btnFree" Background="#7aa700" Foreground="White" Width="70" Height="50" Content="{Binding Path= LocalizedResources.Free_txt, Source={StaticResource LocalizedStrings}}"
                            Padding="0" VerticalAlignment="Top" HorizontalAlignment="Right" FontFamily="Segoe WP SemiLight" FontSize="12" BorderThickness="0" Margin="0,-15,-15,0" Canvas.ZIndex="1"/>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
            <Grid Grid.Row="1" Background="#2c2c2c" MinHeight="30" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" >
                <TextBlock Margin="0,5" FontFamily="Segoe WP SemiLight" TextWrapping="Wrap" Foreground="#878787" FontSize="16" Text="{Binding Path= LocalizedResources.InternetChargesMayApply_txt, Source={StaticResource LocalizedStrings}}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
            </Grid>
        </Grid>

        <Grid Canvas.ZIndex="4" x:Name="WalkieTalkieGrid" Visibility="Collapsed" Grid.RowSpan="2" VerticalAlignment="Center" HorizontalAlignment="Center">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Border  x:Name="WalkieTalkieGridOverlayLayer" Background="{StaticResource HikeBlack}" Opacity="0.95" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.RowSpan="3" />
            <Image Source="/View/images/walkie_talkie_White_Big.png" MaxHeight="133" Margin="0,50,0,0" Stretch="Uniform" HorizontalAlignment="Center"/>
            <StackPanel Grid.Row="1" Margin="0,25" x:Name="timeBar" Orientation="Horizontal" Opacity="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock x:Name="runningTime" FontFamily="Segoe WP SemiLight" FontSize="24" Text="00:00" Foreground="White" ></TextBlock>
                <TextBlock x:Name="maxPlayingTime" Text=" / 2:00" FontFamily="Segoe WP SemiLight" Foreground="White" FontSize="24"/>
            </StackPanel>
            <Border Grid.Row="2" Margin="15,25,15,15" Background="#51ffffff" MouseLeave="deleteRecImage_MouseLeave" x:Name="deleteBorder" BorderThickness="2" BorderBrush="Transparent" MouseEnter="deleteRecImage_MouseEnter" Opacity="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" >
                <StackPanel Canvas.ZIndex="3" Margin="38,23" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Image x:Name="deleteRecImage" MaxHeight="30" Margin="0,0,12,0" Source="/View/images/deleted_white_icon.png" Grid.Column="0" Stretch="Uniform" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="deleteRecText" TextAlignment="Center" Grid.Column="1" FontSize="24" Foreground="White" Text="{Binding Path= LocalizedResources.Drag_Here_To_Delete, Source={StaticResource LocalizedStrings}}"/>
                </StackPanel>
            </Border>
        </Grid>

        <Grid Canvas.ZIndex="4" x:Name="WalkieTalkieDeleteGrid" IsHitTestVisible="False" Background="Transparent" Visibility="Collapsed" Grid.RowSpan="2" VerticalAlignment="Center" HorizontalAlignment="Center">
            <Border x:Name="WalkieTalkieDeletedBorder" Background="{StaticResource HikeBlack}" Opacity="0.95" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
            <StackPanel Canvas.ZIndex="3" Margin="25" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Image x:Name="deleteRecImageSuc" Source="/View/images/deleted_white_icon.png" Margin="0,0,12,0" Grid.Column="0" Height="30" Stretch="Uniform" HorizontalAlignment="Center"/>
                <TextBlock x:Name="deleteRecTextSuc" Foreground="White" TextAlignment="Center" Grid.Column="1" FontSize="24"  Text="{Binding Path= LocalizedResources.Message_Cancelled, Source={StaticResource LocalizedStrings}}"/>
            </StackPanel>
        </Grid>
    </Grid>
</phone:PhoneApplicationPage>
